<?php

/**
 * @file
 * Contains udn_login.module.
 */
use Drupal\Component\Utility\UrlHelper;
use Drupal\Core\Render\Element;

/**
 * Implements hook_theme().
 */
function udn_login_theme() {
  return [
    'html__user__login' => [
      'render element' => 'html',
    ],
    'page__user__login' => [
      'render element' => 'page',
    ],
    'form__user_login_form' => [
      'render element' => 'form',
    ],
    'udn_login' => [
      'render element' => 'element',
    ],
  ];
}

function udn_login_theme_suggestions_form_alter(array &$suggestions,
  array $variables) {
  $suggestions[] = "form__" . $variables['element']['#form_id'];
}

/**
 * Implements hook_preprocess_HOOK().
 */
function udn_login_preprocess_form__user_login_form(&$variables) {
  $element = $variables['element'];
  if (isset($element['#action'])) {
    $element['#attributes']['action'] = UrlHelper::stripDangerousProtocols($element['#action']);
  }
  Element::setAttributes($element, array('method', 'id'));
  if (empty($element['#attributes']['accept-charset'])) {
    $element['#attributes']['accept-charset'] = "UTF-8";
  }
  $variables['attributes'] = $element['#attributes'];
  $variables['children'] = $element['#children'];
}
